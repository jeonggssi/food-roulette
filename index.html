<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>랜덤 요리 뽑기</title>

<style>
body {
    background: radial-gradient(circle, #1a1a1a, #000);
    color: white;
    font-family: Arial;
    text-align: center;
}

h1 {
    margin-top: 30px;
    font-size: 42px;
    letter-spacing: 3px;
}

#roulette-container {
    position: relative;
    width: 300px;
    height: 80px;
    margin: 50px auto;
    overflow: hidden;
    border: 3px solid gold;
    border-radius: 10px;
    background: black;
}

#menu-list {
    position: absolute;
    width: 100%;
}

.menu-item {
    height: 80px;
    line-height: 80px;
    font-size: 28px;
    transition: all 0.3s;
}

button {
    font-size: 24px;
    padding: 15px 40px;
    background: gold;
    border: none;
    border-radius: 10px;
    cursor: pointer;
}

button:hover {
    background: orange;
}

.winner {
    font-size: 44px !important;
    color: gold;
    font-weight: bold;
    text-shadow:
        0 0 10px gold,
        0 0 20px orange,
        0 0 40px yellow;
    transform: scale(1.2);
}
</style>

</head>
<body>

<h1>랜덤 요리 뽑기</h1>

<div id="roulette-container">
    <div id="menu-list"></div>
</div>

<button onclick="start()">START</button>

<script>

const menus = [
    "김치찌개",
    "스테이크",
    "파스타",
    "초밥",
    "치킨",
    "라멘",
    "삼겹살",
    "카레",
    "햄버거",
    "샤브샤브"
];

const list = document.getElementById("menu-list");

let extendedMenus = [];
for(let i=0;i<50;i++){
    extendedMenus = extendedMenus.concat(menus);
}

extendedMenus.forEach(menu=>{
    const div=document.createElement("div");
    div.className="menu-item";
    div.innerText=menu;
    list.appendChild(div);
});

let spinning=false;
let currentOffset=0;

/* 밝고 경쾌한 슬롯머신 회전음 */
function playSpinSound(duration=5000){

    const ctx=new AudioContext();

    let time=0;

    const interval=setInterval(()=>{

        const osc=ctx.createOscillator();
        const gain=ctx.createGain();

        osc.type="square";

        osc.frequency.value=800 + Math.random()*400;

        gain.gain.value=0.1;

        osc.connect(gain);
        gain.connect(ctx.destination);

        osc.start();
        osc.stop(ctx.currentTime+0.05);

        time+=50;

        if(time>=duration){
            clearInterval(interval);
        }

    },50);

}

/* 당첨음 */
function playWinSound(){

    const ctx=new AudioContext();

    const osc1=ctx.createOscillator();
    const osc2=ctx.createOscillator();

    const gain=ctx.createGain();

    osc1.frequency.value=800;
    osc2.frequency.value=1200;

    osc1.type="sine";
    osc2.type="sine";

    gain.gain.value=0.3;

    osc1.connect(gain);
    osc2.connect(gain);

    gain.connect(ctx.destination);

    osc1.start();
    osc2.start();

    osc1.stop(ctx.currentTime+0.5);
    osc2.stop(ctx.currentTime+0.5);

}

/* 회전 시작 */
function start(){

    if(spinning) return;

    spinning=true;

    playSpinSound(5000);

    const itemHeight=80;

    const randomIndex=Math.floor(Math.random()*menus.length);

    const extraSpin = menus.length * (5 + Math.random()*5);

    const moveCount = extraSpin + randomIndex;

    const newOffset = currentOffset + moveCount*itemHeight;

    list.style.transition="transform 5s cubic-bezier(.15,.8,.25,1)";
    list.style.transform=`translateY(-${newOffset}px)`;

    setTimeout(()=>{

        const items=document.querySelectorAll(".menu-item");

        items.forEach(i=>i.classList.remove("winner"));

        const winnerIndex = Math.floor(newOffset/itemHeight);

        items[winnerIndex].classList.add("winner");

        playWinSound();

        currentOffset=newOffset;

        spinning=false;

    },5000);

}

</script>

</body>
</html>
