<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>랜덤 요리 뽑기</title>

<style>
body {
    background: radial-gradient(circle, #1a1a1a, #000);
    color: white;
    font-family: Arial;
    text-align: center;
}

h1 {
    margin-top: 30px;
    font-size: 42px;
    letter-spacing: 3px;
}

#roulette-container {
    position: relative;
    width: 300px;
    height: 80px;
    margin: 50px auto;
    overflow: hidden;
    border: 3px solid gold;
    border-radius: 10px;
    background: black;
}

#menu-list {
    position: absolute;
    width: 100%;
}

.menu-item {
    height: 80px;
    line-height: 80px;
    font-size: 28px;
    transition: all 0.3s;

    display:flex;
    align-items:center;
    justify-content:center;
}

button {
    font-size: 24px;
    padding: 15px 40px;
    background: gold;
    border: none;
    border-radius: 10px;
    cursor: pointer;
}

button:hover {
    background: orange;
}

.winner {
    font-size: 44px !important;
    color: gold;
    font-weight: bold;
    text-shadow: 0 0 20px gold,
}
</style>

</head>
<body>

<h1>랜덤 요리 뽑기</h1>

<div id="roulette-container">
    <div id="menu-list"></div>
</div>

<button onclick="start()">START</button>

<script>

const menus = [
    "김치찌개",
    "스테이크",
    "파스타",
    "초밥",
    "치킨",
    "라멘",
    "삼겹살",
    "카레",
    "햄버거",
    "샤브샤브"
];

const list = document.getElementById("menu-list");

let extendedMenus = [];
for(let i=0;i<20;i++){
    extendedMenus = extendedMenus.concat(menus);
}

extendedMenus.forEach(menu=>{
    const div=document.createElement("div");
    div.className="menu-item";
    div.innerText=menu;
    list.appendChild(div);
});

let spinning=false;
let currentOffset=0;

const duration = 3500;
const itemHeight = 80;
const containerHeight = 80;
    
/* 밝고 경쾌한 슬롯머신 회전음 */
function playSpinSound(duration=5000){
    const ctx=new AudioContext();
    const osc=ctx.createOscillator();
    const gain=ctx.createGain();

    osc.type="triangle";
    osc.frequency.setValueAtTime(100, ctx.currentTime);
    osc.frequency.exponentialRampToValueAtTime(40, ctx.currentTime+duration/1000);

    gain.gain.setValueAtTime(0.3, ctx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime+duration/1000);

    osc.connect(gain);
    gain.connect(ctx.destination);

    osc.start();
    osc.stop(ctx.currentTime+duration/1000);
}

/* 당첨음 */
function playWinSound(){
    const ctx=new AudioContext();

    const osc=ctx.createOscillator();
    const gain=ctx.createGain();

    osc.type="sine";
    osc.frequency.setValueAtTime(800, ctx.currentTime);
    osc.frequency.exponentialRampToValueAtTime(1200, ctx.currentTime+0.3);

    gain.gain.setValueAtTime(0.5, ctx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime+1);

    osc.connect(gain);
    gain.connect(ctx.destination);

    osc.start();
    osc.stop(ctx.currentTime+1);
}

/* 회전 시작 */
function start(){

    if(spinning) return;

    spinning=true;

    playSpinSound(3500);

    const randomIndex = Math.floor(Math.random()*menus.length);

    const extraSpin = menus.length * (4 + Math.random()*3);

    const winnerIndex = Math.floor(currentOffset/itemHeight) + extraSpin + randomIndex;

    /* 당첨 메뉴를 정확히 중앙에 위치시키는 offset */
    const finalOffset = (winnerIndex * itemHeight) - ((containerHeight/2) - (itemHeight/2));

    list.style.transition = `transform ${duration}ms cubic-bezier(.17,.67,.25,1)`;

    list.style.transform = `translateY(-${finalOffset}px)`;

    setTimeout(()=>{

        const items=document.querySelectorAll(".menu-item");

        items.forEach(i=>i.classList.remove("winner"));

        items[winnerIndex].classList.add("winner");

        currentOffset = winnerIndex * itemHeight;

        playWinSound();

        spinning=false;

    },duration);

}

</script>

</body>
</html>




